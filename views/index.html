{% extends "parent.html" %}

{% block script %}
<script>

function updateLocation() {
  var json = 'http://ip-api.com/json/?fields=status,city';
  const xhr = new XMLHttpRequest();

  xhr.onreadystatechange = function() {
	if (this.readyState == 4 && this.status == 200) {
		var response = JSON.parse(this.responseText);
		if(response.status !== 'success') {
			console.log('query failed: ' + response.message);
			return
		}
    console.log(response.city);
    document.getElementById("location").value = response.city;
  }}

    xhr.open('GET', json, true);
    xhr.send();
};

</script>

{% endblock %}

{% block navbar %}
<nav class="navbar navbar-transparent">
     <!-- logo -->
     <a class="navbar-brand" href="#">
          <img src="/public/images/logo.png" alt="not working" height="100" width="215">
     </a>

     <button type="button" class="btn btn-danger btn-lg" data-toggle="modal" data-target="#exampleModal">
          <i class="far fa-edit"></i>
          Add to the Wall
     </button>
</nav>
{% endblock %}

{% block extras %}
<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
     <div class="modal-dialog" role="document">
          <div class="modal-content">
               <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Post of Thanks</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                         <span aria-hidden="true">&times;</span>
                    </button>
               </div>
               <form action="/cards/create" method="POST">
                    <div class="modal-body">
                         <div class="form-group">
                              <label for="Input1">Name</label>
                              <input type="text" class="form-control" id="name" name="name" placeholder="Vishwaa Sofat"
                                   required>
                         </div>
                         <div class="form-group">
                              <label for="formGroupExampleInput2">Location</label>
                              <button type="button" class="btn btn-labeled btn-primary" onclick="updateLocation();">
                                <span class="btn-label"><i class="map-marker-alt"></i></span>Location</button>
                              <input type="text" class="form-control" id="location" name="location"
                                   placeholder="New York, NY" required>

                         </div>
                         <div class="form-group">
                              <label for="Input3">Message</label>
                              <textarea rows="5" class="form-control" id="message" name="message"
                                   placeholder="I am thankful for the first-line workers who protected me and my loved ones in this dangerous time."
                                   required></textarea>
                         </div>
                    </div>
                    <div class="modal-footer">
                         <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                         <button type="submit" class="btn btn-primary">Create Post</button>
                    </div>
               </form>
          </div>
     </div>
</div>
{% endblock %}

{% block insert %}
     <br>
     <div class="row">
          <div class="container col-md-2 bg-danger border border-danger text-primary" style="padding: 1em; border-radius: 0.5em;">
               <!-- example header -->
               <p><small>Ahmed Sultan, <i>New York</i></small></p>
               <!-- example content -->
               <p>This is a post on the Wall of Thanks. Big thanks! Wow, amazing. This is great.</p>
               <!-- example rating? -->
               <p><i class="far fa-heart"></i> 100</p>
          </div>
          <div class="container col-md-3 bg-light border border-danger text-danger" style="padding: 1em; border-radius: 0.5em;">
               <!-- example header -->
               <p><small>Vishwaa Sofat, <i>Shanghai</i></small></p>
               <!-- example content -->
               <p>This is another post on the Wall of Thanks. Big thanks! Wow, amazing. This is great. My name is Vishwaa. Did you know that? I knew that. Why am I in Shanghai? Thank you, thank you. This has been me typing. Yes.</p>
               <!-- example rating? -->
               <span class="align-bottom"><i class="far fa-heart"></i> 51</span>
          </div>
          <div class="container col-md-3 bg-danger border border-danger text-primary" style="padding: 1em; border-radius: 0.5em;">
               <!-- example header -->
               <p><small>Kazi Jamal, <i>Birmingham</i></small></p>
               <!-- example content -->
               <p>This is a third post on the Wall of Thanks. That is all.</p>
               <!-- example rating? -->
               <span class="align-bottom"><i class="far fa-heart"></i> 999</span>
          </div>
          <div class="container col-md-3 bg-danger border border-danger" style="padding: 1em; border-radius: 0.5em;">
               <br>
               <br>
               <br>
               <br>
               <br>
               <br>
          </div>
     </div>
     <br>
     <div class="row">
          <div class="container col-md-4 bg-danger border border-danger" style="padding: 1em; border-radius: 0.5em;">
               <br>
               <br>
               <br>
               <br>
               <br>
               <br>
          </div>
          <div class="container col-md-2 bg-light border border-danger" style="padding: 1em; border-radius: 0.5em;">
               <br>
               <br>
               <br>
               <br>
               <br>
               <br>
          </div>
          <div class="container col-md-3 bg-danger border border-danger" style="padding: 1em; border-radius: 0.5em;">
               <br>
               <br>
               <br>
               <br>
               <br>
               <br>
          </div>
          <div class="container col-md-2 bg-light border border-danger" style="padding: 1em; border-radius: 0.5em;">
               <br>
               <br>
               <br>
               <br>
               <br>
               <br>
          </div>
     </div>
{% endblock %}
